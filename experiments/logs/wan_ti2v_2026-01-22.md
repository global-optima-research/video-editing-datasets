# Wan2.2 TI2V 实验记录

## 实验信息

- **日期**: 2026-01-22
- **目标**: 测试 Wan2.2 TI2V 5B 能否通过相同 seed 生成运动一致的视频对
- **模型**: Wan2.2 TI2V 5B
- **GPU**: NVIDIA RTX 5090 32GB

## 实验背景

新 Pipeline 设想：
1. 用 Flux.2 Dev 编辑首帧（手链 → 项链）
2. 用相同 seed + 相同运镜 prompt 生成两个视频
3. 期望两个视频具有一致的运动轨迹

## 测试数据

使用 PVTT benchmark 数据：
- **source_frame1.png**: 手链首帧 (832x480 → 1280x704)
- **target_frame1.png**: 项链首帧 (832x480 → 1280x704)
- **原视频运镜**: 俯拍视角，相机围绕产品旋转

## 实验配置

```bash
# 通用参数
--task ti2v-5B
--ckpt_dir Wan2.2-TI2V-5B
--size 1280*704
--frame_num 49
--base_seed 42
--offload_model true
```

## 实验结果

### 测试 1: 种子一致性验证

**目的**: 验证相同 seed 是否产生相同输出

```bash
# 第一次运行
--image frame_000.png --prompt "..." --base_seed 42 → bracelet_seed42.mp4

# 第二次运行（完全相同参数）
--image frame_000.png --prompt "..." --base_seed 42 → bracelet_seed42_v2.mp4
```

**结果**: ✅ MD5 哈希完全一致，证明相同 seed 产生确定性输出

### 测试 2: 不同首帧 + 相同 seed (v1)

**Prompt**: "Elegant jewelry on purple silk fabric, the camera slowly pans around, soft studio lighting, product photography"

| 视频 | 首帧 | seed |
|------|------|------|
| source_video_seed42.mp4 | 手链 | 42 |
| target_video_seed42.mp4 | 项链 | 42 |

**结果**: ❌ 两个视频运动轨迹完全不同

### 测试 3: 不同首帧 + 相同 seed (v2 - orbit prompt)

**Prompt**: "...camera slowly orbits around the jewelry, top-down rotating view..."

| 视频 | 首帧 | seed |
|------|------|------|
| source_video_v2.mp4 | 手链 | 42 |
| target_video_v2.mp4 | 项链 | 42 |

**结果**: ❌ 两个视频运动轨迹不同，且都不是 orbit

### 测试 4: 不同首帧 + 相同 seed (v3 - rotate prompt)

**Prompt**: "...camera rotates clockwise around the product, spinning aerial view, smooth rotation..."

| 视频 | 首帧 | seed |
|------|------|------|
| source_video_v3.mp4 | 手链 | 42 |
| target_video_v3.mp4 | 项链 | 42 |

**结果**: 待评估

## 关键发现

1. **Seed 一致性**: ✅ 相同首帧 + 相同 seed = 完全相同的视频输出
2. **运动可控性**: ❌ Prompt 对运动的控制能力有限，生成的运动不一定符合 prompt 描述
3. **跨首帧一致性**: ❌ 不同首帧即使用相同 seed，运动轨迹也完全不同

## 结论

**TI2V 同 seed 方案不可行**

Wan2.2 TI2V 的运动生成主要由**首帧图像内容**决定，而非 seed 或 prompt 控制。Seed 只保证相同首帧的输出一致性，无法实现跨首帧的运动迁移。

## 替代方案建议

1. **RF-Solver Inversion + TI2V**: 从源视频提取运动 latent，迁移到目标首帧
2. **FlowEdit/FlowAlign**: 直接在视频层面编辑
3. **Motion Transfer 模型**: 专门的运动迁移方法

## 输出文件

```
experiments/results/wan_ti2v/pvtt_reference/
├── source_frame1.png
├── target_frame1.png
├── source_video_seed42.mp4
├── target_video_seed42.mp4
├── source_video_v2.mp4
├── target_video_v2.mp4
├── source_video_v3.mp4
└── target_video_v3.mp4
```

## 服务器路径

- 代码: `/data/xuhao/Wan2.2/`
- 模型: `/data/xuhao/Wan2.2/Wan2.2-TI2V-5B/`
- 测试数据: `/data/xuhao/pvtt_test/`
